<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>{% block title %}GetAJob{% endblock %}</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">

  <!-- Minimal, scoped styles to place an overlay badge centered inside the left brand circle.
       This is intentionally small and targets only .brand-circle so it won't affect other styling. -->
  <style>
    /* ensure .brand-circle can host an absolutely-positioned overlay */
    .brand-circle { position: relative; }

    /* overlay sits centered in the circle (upper-left area of header because the circle is there) */
    .brand-circle .logo-overlay {
      position: absolute;
      left: 50%;
      top: 50%;
      transform: translate(-50%, -50%);
      width: var(--badge-size, 100%);
      height: auto;
      pointer-events: none; 
      z-index: 3;
      filter: drop-shadow(0 2px 6px rgba(0,0,0,0.18));
      background: transparent;
    }

    /* make overlay a bit smaller on very small screens */
    @media (max-width: 480px) {
      .brand-circle .logo-overlay { width: 34px; height: 34px; }
    }
  </style>
</head>

<script>
// Check for warnings
document.addEventListener('DOMContentLoaded', function() {
    fetch('/check-warnings')
        .then(r => r.json())
        .then(data => {
            if (data.warnings && data.warnings.length > 0) {
                showWarning(data.warnings[0]);
            }
        });
});

function showWarning(warning) {
    // Create simple popup
    const div = document.createElement('div');
    div.innerHTML = `
        <div style="position:fixed; top:20px; right:20px; background:#fff3cd; border-left:4px solid #ffc107; 
                    padding:15px; border-radius:4px; box-shadow:0 2px 10px rgba(0,0,0,0.1); z-index:1000; 
                    max-width:400px;">
            <div style="font-weight:bold; margin-bottom:5px;">⚠️ Admin Warning</div>
            <div style="margin-bottom:10px;">${warning.message}</div>
            <button onclick="this.parentElement.parentElement.remove()" 
                    style="background:#ffc107; border:none; padding:5px 15px; border-radius:3px; cursor:pointer;">
                Dismiss
            </button>
        </div>
    `;
    document.body.appendChild(div.firstChild);
}
</script>

<body>
  <header class="site-header" role="banner">
    <div class="container header-inner">
      <div class="left-area">
        <!-- Left logo links to home -->
        <a class="brand-left" href="{{ url_for('index') }}" aria-label="Home">
          <div class="brand-circle" aria-hidden="true">
            <img src="{{ url_for('static', filename='logo.png') }}" srcset="{{ url_for('static', filename='logo@2x.png') }} 2x" alt="GetAJob" onerror="this.style.display='none'">
            <div class="brand-fallback">GetAJob</div>

            {# Overlay badge centered inside the blue circle.
               Place your badge image into static/logo-overlay.png (or change filename below). #}
            <img class="logo-overlay" src="{{ url_for('static', filename='logo-overlay.png') }}" alt="" onerror="this.style.display='none'">
          </div>
        </a>

        <button class="prev-pill" onclick="history.back()" title="Previous page">
          ← Previous Page
        </button>
      </div>

      <div class="center-spacer"></div>

      <nav class="main-nav" aria-label="Main navigation">
        <a class="nav-link" href="{{ url_for('index') }}">Home</a>
        <a class="nav-link" href="{{ url_for('jobs_list') }}">Find Jobs</a>
        <a class="nav-link" href="{{ url_for('map_view') }}">Maps</a>
        <a class="nav-link" href="{{ url_for('messages_page') }}">Messages</a>

        {% if current_user.is_authenticated %}
          <a class="btn btn-outline" href="{{ url_for('profile') }}">Profile</a>
          <form class="inline-form" action="{{ url_for('logout') }}" method="get" style="display:inline;">
            <button class="btn btn-ghost" type="submit">Log Out</button>
          </form>
        {% else %}
          <a class="btn btn-linkish" href="{{ url_for('signin') }}">Log In</a>
        {% endif %}
      </nav>

      <!-- Right-side logo removed on purpose -->

      <button class="nav-toggle" aria-expanded="false" aria-controls="mobile-nav" title="Toggle navigation">
        <span class="hamburger"></span>
      </button>
    </div>

    <!-- Mobile nav: hidden on desktop, only available at small widths -->
    <div id="mobile-nav" class="mobile-nav" aria-hidden="true">
      <div class="container mobile-inner">
        <a class="mobile-link" href="{{ url_for('index') }}">Home</a>
        <a class="mobile-link" href="{{ url_for('jobs_list') }}">Find Jobs</a>
        <a class="mobile-link" href="{{ url_for('map_view') }}">Maps</a>
        <a class="mobile-link" href="{{ url_for('messages_page') }}">Messages</a>
        {% if current_user.is_authenticated %}
          <a class="mobile-link" href="{{ url_for('profile') }}">Profile</a>
          <form class="inline-form" action="{{ url_for('logout') }}" method="get">
            <button class="btn btn-ghost" type="submit">Log Out</button>
          </form>
        {% else %}
          <a class="mobile-link" href="{{ url_for('signin') }}">Log In</a>
        {% endif %}
      </div>
    </div>
  </header>

  <main class="container main-content" role="main">
    {% with messages = get_flashed_messages(with_categories=true) %}
      {% if messages %}
        <div class="flashes" role="status" aria-live="polite">
          {% for category, msg in messages %}
            <div class="flash flash-{{ category }}">{{ msg }}</div>
          {% endfor %}
        </div>
      {% endif %}
    {% endwith %}

    {% block content %}{% endblock %}
  </main>

  <footer class="site-footer">
    <div class="container footer-inner">
      <div>&copy; {{ current_year }} GetAJob</div>
    </div>
  </footer>

  {% block scripts %}
  <script>
    // Basic mobile nav toggle (keeps behavior consistent with previous layout)
    (function(){
      var toggle = document.querySelector('.nav-toggle');
      var mobileNav = document.getElementById('mobile-nav');
      if (!toggle || !mobileNav) return;
      toggle.addEventListener('click', function(){
        var expanded = this.getAttribute('aria-expanded') === 'true';
        this.setAttribute('aria-expanded', !expanded);
        if (mobileNav.classList.contains('open')){
          mobileNav.classList.remove('open');
          mobileNav.setAttribute('aria-hidden', 'true');
        } else {
          mobileNav.classList.add('open');
          mobileNav.setAttribute('aria-hidden', 'false');
        }
      });
    })();
  </script>
  {% endblock %}
</body>
</html>