{% extends "layout.html" %}

{% block content %}
<h2>Admin â€” Users</h2>

<p><a href="{{ url_for('admin_reviews') }}">All ratings (review feed)</a></p>

<table style="width:100%; border-collapse: collapse;">
  <thead>
    <tr style="text-align:left; border-bottom:1px solid #ccc;">
      <th style="padding:8px;">ID</th>
      <th style="padding:8px;">Email</th>
      <th style="padding:8px;">Role</th>
      <th style="padding:8px;">Banned</th>
      <th style="padding:8px;">Created</th>
      <th style="padding:8px;">Actions</th>
    </tr>
  </thead>
  <tbody>
    {% for u in users %}
      <tr style="border-bottom:1px solid #eee;">
        <td style="padding:8px;">{{ u.id }}</td>
        <td style="padding:8px;">{{ u.email }}</td>
        <td style="padding:8px;">{{ u.role }}</td>
        <td style="padding:8px;">{% if u.is_banned %}Yes{% else %}No{% endif %}</td>
        <td style="padding:8px;">{{ u.created_at }}</td>
        <td style="padding:8px;">
          <a href="{{ url_for('admin_user_reviews', user_id=u.id) }}">Reviews</a>
          {% if u.role != 'admin' %}
            | <form method="post" action="{{ url_for('admin_delete_user', user_id=u.id) }}" style="display:inline;" onsubmit="return confirm('Delete user and their jobs?');">
                <button type="submit" style="background:none;border:none;color:#c00;cursor:pointer;padding:0;margin-left:8px;">Delete</button>
              </form>
          {% endif %}
          {% if not u.is_banned %}
            <form method="post" action="{{ url_for('admin_ban_user', user_id=u.id) }}" style="display:inline;">
              <input type="hidden" name="days" value="7">
              <button type="submit" style="background:none;border:none;color:#c60;cursor:pointer;padding:0;margin-left:8px;">Ban 7d</button>
            </form>
          {% else %}
            <form method="post" action="{{ url_for('admin_unban_user', user_id=u.id) }}" style="display:inline;">
              <button type="submit" style="background:none;border:none;color:#060;cursor:pointer;padding:0;margin-left:8px;">Unban</button>
            </form>
          {% endif %}
        </td>
      </tr>
    {% endfor %}
  </tbody>
</table>
{% endblock content %}