{% extends "layout.html" %}

{% block title %}Reset password — GetAJob{% endblock %}

{% block content %}
<div class="card" style="max-width:520px; margin:24px auto; padding:20px;">
  <h2 style="margin-top:0; color:var(--primary);">Choose a new password</h2>
  <p class="meta" style="color:#666; margin-top:6px;">
    Enter a new secure password for your account.
  </p>

  <form id="resetForm" method="post" action="{{ url_for('reset_password', token=token) }}" style="margin-top:12px;">
    <label for="password">New password</label>
    <input id="password" name="password" class="input" type="password" required autocomplete="new-password" />

    <label for="confirm_password" style="margin-top:10px;">Confirm password</label>
    <input id="confirm_password" name="confirm_password" class="input" type="password" required autocomplete="new-password" />

    <div id="pwError" style="color:#b92a2a; display:none; margin-top:8px; font-size:0.95rem;"></div>

    <div class="form-actions" style="margin-top:14px; display:flex; gap:8px; align-items:center;">
      <button class="btn btn-primary" id="submitBtn" type="submit">Set password</button>
      <a class="btn btn-outline" href="{{ url_for('signin') }}">Cancel</a>
    </div>
  </form>

  <div style="margin-top:12px; color:var(--muted); font-size:0.95rem;">
    Passwords must meet the site policy (minimum length and complexity). The server will validate and enforce rules.
  </div>
</div>

<script>
(function(){
  const form = document.getElementById('resetForm');
  const pw = document.getElementById('password');
  const confirm = document.getElementById('confirm_password');
  const err = document.getElementById('pwError');

  form.addEventListener('submit', function(e){
    err.style.display = 'none';
    const p = (pw.value || '').trim();
    const c = (confirm.value || '').trim();

    if (!p || p.length < 8) {
      e.preventDefault();
      err.textContent = 'Password must be at least 8 characters.';
      err.style.display = 'block';
      return false;
    }
    if (p !== c) {
      e.preventDefault();
      err.textContent = 'Passwords do not match.';
      err.style.display = 'block';
      return false;
    }
    // allow submit — server will perform full validation
  });
})();
</script>
{% endblock %}